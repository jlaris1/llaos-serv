extends ../../../layouts/layout.jade
block contenido
    style.
        
    script.
        $(document).ready( function(){
            obtenerfecha();
            obtenerhora(); 

            $('#subMenuAdministracion').removeClass('hidden');
            $('#spanMenuAdministracion').removeClass('fa-angle-left');
            $('#spanMenuAdministracion').addClass('fa-angle-down'); 
            $('#subMenuAdmGranja').removeClass('hidden');
            $('#spanMenuAdmGranja').removeClass('fa-angle-left');
            $('#spanMenuAdmGranja').addClass('fa-angle-down');
            $('#subMenuEstanques').removeClass('hidden');
            $('#spanMenuEstanques').removeClass('fa-angle-left');
            $('#spanMenuEstanques').addClass('fa-angle-down');
            $('#subMenuEstanques').removeClass('hidden');
            $('#spanMenuEstanques').removeClass('fa-angle-left');
            $('#spanMenuEstanques').addClass('fa-angle-down');

            $('#code').on('keyup', function(){
                $('#name').val('Estanque '+ this.value);
            });

            // Mostrar Mapa
            //var mymap = L.map('map').setView([27.307156, -110.423355], 16);
            var mymap = L.map('map').setView([$('#pointerx').val(),$('#pointery').val()], 16);

            L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',{
                maxZoom: 20,
                subdomains:['mt0','mt1','mt2','mt3']
            }).addTo(mymap);

            // Marcadores en Mapa
            //var marker = L.marker([27.307141, -110.423128]).addTo(mymap);
            var marker = L.marker([$('#markerx').val(),$('#markery').val()]).addTo(mymap);

            var locations = [];
            var prb = $('#locations').val();
            locations = prb.slice(1, -1);
            alert(prb.slice(1, -1));

            var location = [
                [27.308601, -110.423742],
                [27.308641, -110.423117],
                [27.308630, -110.422525],
                [27.308531, -110.422414],
                [27.304616, -110.422308],
                [27.304465, -110.422385],
                [27.304474, -110.422849],
                [27.304552, -110.422973],
                [27.307053, -110.423906],
                [27.308455, -110.423958]
            ];

            //var location = locations;

            // Crear diujo del estanque
            var polygon = L.polygon(location).addTo(mymap);

            // Creación de gráficos
            var ctx = document.getElementById('myChart');

            var chart = new Chart(ctx, {
                // The type of chart we want to create
                type: 'line',

                // The data for our dataset
                data: {
                    labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
                    datasets: [{
                        label: 'pH',
                        backgroundColor: 'rgb(255, 99, 132)',
                        borderColor: 'rgb(255, 99, 132)',
                        data: [0, 10, 5, 2, 20, 30, 45]
                    }]
                },

                // Configuration options go here
                options: {
                    /*animation: {
                        onProgress: function(animation) {
                            progress.value = animation.animationObject.currentStep / animation.animationObject.numSteps;
                        }
                    }*/
                }
            });
        });

        function obtenerfecha(){
            var fecha = new Date()
            var dia = fecha.getDate();
            var mes = fecha.getMonth()+1;
            var anio = fecha.getFullYear();

            if(dia < 10){
                dia = "0"+dia;
            }

            if(mes < 10){
                mes = "0"+mes;
            }

            $("#fecha").text(dia+"/"+mes+"/"+anio+"    ");
        }

        function obtenerhora(){
            var tiempo = new Date();
            var horas = tiempo.getHours();
            var minutos = tiempo.getMinutes();
            var segundos = tiempo.getSeconds();
            var dn ="";

            if(horas < 12){
                dn = "a.m.";
            }else{
                dn = "p.m.";
            }

            if(minutos < 10){
                minutos = "0"+minutos;
            }

            if(segundos < 10){
                segundos = "0"+segundos;
            }
                
            $("#hora").text(horas+":"+minutos+":"+segundos+" "+dn+"    ");

            setTimeout('obtenerhora()',1000);
            //console.log("un segundo mas...");
        }
    .row
        .col-lg-12.col-md-12.col-xs-12
            h2
                i.fas.fa-water(style="margin-right: 10px;")
                |   Detalle del Estanque 
                strong #{ estanque.codigo }
        .divider
    input.hidden#locations(value="#{JSON.stringify(locations)}")
    input.hidden#markerx(value="#{estanque.marker_x}")
    input.hidden#markery(value="#{estanque.marker_y}")
    input.hidden#pointerx(value="#{estanque.pointer_x}")
    input.hidden#pointery(value="#{estanque.pointer_y}")
    .row
        .col-lg-3.col-sm-3
            .card.card-default
                .card-body.card-5-7
                    span 
                        b Nombre: 
                        |   #{ estanque.nombre}
                    br
                    span 
                        b Módulo: 
                        |   #{ estanque.modulo.nombre}
                    br
                    span 
                        b Tipo: 
                        |   #{ estanque.tipo.nombre}
            .card.card-default
                .card-body.card-5-7
                    h4  Parametros del Día
                    span 
                        b pH: 
                        |   7
                    br
                    span 
                        b °C: 
                        |   25
                    br
                    span 
                        b 0
                        sub
                            b 2
                        b : 
                        |   3ppm
        .col-lg-4.col-sm-6
            #map(style="width: 100%; min-height: 300px;")
        .col-lg-5
            .form-group
                    label | Parámetro
                    .input-group
                        span.input-group-addon
                            i.fas.fa-vial
                        select.form-control(name="parametro" tabindex="8")
                            option(value="") << Seleccione >>
                            option(value="ph") pH
                            option(value="ocigeno") Oxigeno
                            option(value="temperatura") Temperatura
                            option(value="salinidad") Salinidad
                            option(value="nivel") Nivel de Agua

            canvas#myChart


